# Copyright (c) 2024 ROS2 OpenHarmony Port Project
# std_msgs - ROS2 standard message types

import("//build/ohos.gni")
import("//gn_templates/ros2_library.gni")

# Package name
_package_name = "std_msgs"

# ============================================================================
# std_msgs message types:
# Primitives: Bool, Byte, Char, Empty, Float32, Float64,
#             Int8, Int16, Int32, Int64, UInt8, UInt16, UInt32, UInt64, String
# Compound: Header, ColorRGBA, MultiArrayDimension, MultiArrayLayout
# Arrays: ByteMultiArray, Float32MultiArray, Float64MultiArray, Int8MultiArray,
#         Int16MultiArray, Int32MultiArray, Int64MultiArray, UInt8MultiArray,
#         UInt16MultiArray, UInt32MultiArray, UInt64MultiArray
# ============================================================================

# ============================================================================
# std_msgs C generator library
# ============================================================================
ros2_shared_library("std_msgs__rosidl_generator_c") {
  sources = [
    # Primitive types
    "src/msg/bool__functions.c",
    "src/msg/byte__functions.c",
    "src/msg/char__functions.c",
    "src/msg/empty__functions.c",
    "src/msg/float32__functions.c",
    "src/msg/float64__functions.c",
    "src/msg/int8__functions.c",
    "src/msg/int16__functions.c",
    "src/msg/int32__functions.c",
    "src/msg/int64__functions.c",
    "src/msg/uint8__functions.c",
    "src/msg/uint16__functions.c",
    "src/msg/uint32__functions.c",
    "src/msg/uint64__functions.c",
    "src/msg/string__functions.c",

    # Compound types
    "src/msg/header__functions.c",
    "src/msg/color_rgba__functions.c",
    "src/msg/multi_array_dimension__functions.c",
    "src/msg/multi_array_layout__functions.c",

    # MultiArray types
    "src/msg/byte_multi_array__functions.c",
    "src/msg/float32_multi_array__functions.c",
    "src/msg/float64_multi_array__functions.c",
    "src/msg/int8_multi_array__functions.c",
    "src/msg/int16_multi_array__functions.c",
    "src/msg/int32_multi_array__functions.c",
    "src/msg/int64_multi_array__functions.c",
    "src/msg/uint8_multi_array__functions.c",
    "src/msg/uint16_multi_array__functions.c",
    "src/msg/uint32_multi_array__functions.c",
    "src/msg/uint64_multi_array__functions.c",
  ]

  include_dirs = [
    "include",
  ]

  deps = [
    "//foundation/rcutils:rcutils",
    "//foundation/rosidl/rosidl_runtime_c:rosidl_runtime_c",
    "//interfaces/builtin_interfaces:builtin_interfaces__rosidl_generator_c",
  ]

  defines = [
    "ROSIDL_GENERATOR_C_BUILDING_DLL_${_package_name}",
  ]

  part_name = "ros2_foundation"
  subsystem_name = "ros2"
}

# ============================================================================
# std_msgs type support C library
# ============================================================================
ros2_shared_library("std_msgs__rosidl_typesupport_c") {
  sources = [
    # Primitive types
    "src/msg/bool__type_support.c",
    "src/msg/byte__type_support.c",
    "src/msg/char__type_support.c",
    "src/msg/empty__type_support.c",
    "src/msg/float32__type_support.c",
    "src/msg/float64__type_support.c",
    "src/msg/int8__type_support.c",
    "src/msg/int16__type_support.c",
    "src/msg/int32__type_support.c",
    "src/msg/int64__type_support.c",
    "src/msg/uint8__type_support.c",
    "src/msg/uint16__type_support.c",
    "src/msg/uint32__type_support.c",
    "src/msg/uint64__type_support.c",
    "src/msg/string__type_support.c",

    # Compound types
    "src/msg/header__type_support.c",
    "src/msg/color_rgba__type_support.c",
    "src/msg/multi_array_dimension__type_support.c",
    "src/msg/multi_array_layout__type_support.c",

    # MultiArray types
    "src/msg/byte_multi_array__type_support.c",
    "src/msg/float32_multi_array__type_support.c",
    "src/msg/float64_multi_array__type_support.c",
    "src/msg/int8_multi_array__type_support.c",
    "src/msg/int16_multi_array__type_support.c",
    "src/msg/int32_multi_array__type_support.c",
    "src/msg/int64_multi_array__type_support.c",
    "src/msg/uint8_multi_array__type_support.c",
    "src/msg/uint16_multi_array__type_support.c",
    "src/msg/uint32_multi_array__type_support.c",
    "src/msg/uint64_multi_array__type_support.c",
  ]

  include_dirs = [
    "include",
  ]

  deps = [
    ":std_msgs__rosidl_generator_c",
    "//foundation/rcutils:rcutils",
    "//foundation/rosidl/rosidl_runtime_c:rosidl_runtime_c",
    "//foundation/rosidl/rosidl_typesupport_c:rosidl_typesupport_c",
    "//foundation/rosidl/rosidl_typesupport_introspection_c:rosidl_typesupport_introspection_c",
    "//interfaces/builtin_interfaces:builtin_interfaces__rosidl_typesupport_c",
  ]

  defines = [
    "ROSIDL_TYPESUPPORT_C_BUILDING_DLL",
  ]

  part_name = "ros2_foundation"
  subsystem_name = "ros2"
}

# ============================================================================
# std_msgs FastRTPS type support
# ============================================================================
ros2_shared_library("std_msgs__rosidl_typesupport_fastrtps_c") {
  sources = [
    # Key message types for FastRTPS
    "src/msg/string__rosidl_typesupport_fastrtps_c.cpp",
    "src/msg/header__rosidl_typesupport_fastrtps_c.cpp",
    "src/msg/bool__rosidl_typesupport_fastrtps_c.cpp",
    "src/msg/int32__rosidl_typesupport_fastrtps_c.cpp",
    "src/msg/float32__rosidl_typesupport_fastrtps_c.cpp",
    "src/msg/float64__rosidl_typesupport_fastrtps_c.cpp",
  ]

  include_dirs = [
    "include",
  ]

  deps = [
    ":std_msgs__rosidl_generator_c",
    "//foundation/rcutils:rcutils",
    "//foundation/rosidl/rosidl_runtime_c:rosidl_runtime_c",
    "//foundation/rosidl/rosidl_typesupport_fastrtps_c:rosidl_typesupport_fastrtps_c",
    "//vendor/fastdds/fastcdr:fastcdr",
    "//interfaces/builtin_interfaces:builtin_interfaces__rosidl_typesupport_fastrtps_c",
  ]

  defines = [
    "ROSIDL_TYPESUPPORT_FASTRTPS_C_BUILDING_DLL_${_package_name}",
  ]

  cflags_cc = [
    "-Wno-unused-parameter",
  ]

  part_name = "ros2_foundation"
  subsystem_name = "ros2"
}

# ============================================================================
# std_msgs C++ library
# ============================================================================
config("std_msgs_cpp_config") {
  include_dirs = [
    "include",
  ]
}

ros2_shared_library("std_msgs__rosidl_typesupport_cpp") {
  sources = [
    "src/msg/string__type_support.cpp",
    "src/msg/header__type_support.cpp",
    "src/msg/bool__type_support.cpp",
    "src/msg/int32__type_support.cpp",
    "src/msg/float32__type_support.cpp",
    "src/msg/float64__type_support.cpp",
  ]

  include_dirs = [
    "include",
  ]

  deps = [
    ":std_msgs__rosidl_generator_c",
    "//foundation/rosidl/rosidl_runtime_cpp:rosidl_runtime_cpp",
    "//foundation/rosidl/rosidl_typesupport_cpp:rosidl_typesupport_cpp",
    "//foundation/rosidl/rosidl_typesupport_introspection_cpp:rosidl_typesupport_introspection_cpp",
    "//interfaces/builtin_interfaces:builtin_interfaces__rosidl_typesupport_cpp",
  ]

  defines = [
    "ROSIDL_TYPESUPPORT_CPP_BUILDING_DLL",
  ]

  part_name = "ros2_foundation"
  subsystem_name = "ros2"
}

# ============================================================================
# Package group target
# ============================================================================
group("std_msgs") {
  public_deps = [
    ":std_msgs__rosidl_generator_c",
    ":std_msgs__rosidl_typesupport_c",
    ":std_msgs__rosidl_typesupport_cpp",
    ":std_msgs__rosidl_typesupport_fastrtps_c",
  ]

  public_configs = [ ":std_msgs_cpp_config" ]
}
